<!DOCTYPE html>
<html>
<head>
    <title>Tokens with Recent Liquidity Addition</title>
</head>
<body>
    <h1>Tokens with Recent Liquidity Addition (Past 1 Hour)</h1>
    <ul id="tokenList"></ul>

    <script>
        const graphEndpoint = "https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2";

        // Initialize The Graph client
        const graphClient = new window.GraphQLClient(graphEndpoint);

        // GraphQL query to fetch token pairs with their last liquidity addition timestamp
        const query = `
          {
            pairs(first: 1000, orderBy: createdAtTimestamp, orderDirection: desc) {
              id
              token0 {
                symbol
              }
              token1 {
                symbol
              }
              createdAtTimestamp
            }
          }
        `;

        graphClient.request(query)
          .then(data => displayTokensWithLiquidity(data))
          .catch(error => console.error('Error fetching data:', error));

        function displayTokensWithLiquidity(data) {
          const tokenListElement = document.getElementById("tokenList");
          const currentTime = Math.floor(Date.now() / 1000);
          const oneHourAgo = currentTime - (60 * 60); // 1 hour ago

          data.pairs.forEach(pair => {
            if (pair.createdAtTimestamp >= oneHourAgo) {
              const listItem = document.createElement("li");
              listItem.textContent = `Pair: ${pair.token0.symbol} - ${pair.token1.symbol}, Last Liquidity Addition: ${new Date(pair.createdAtTimestamp * 1000)}`;
              tokenListElement.appendChild(listItem);
            }
          });
        }
    </script>
</body>
</html>
