<!DOCTYPE html>
<html>
<head>
  <title>Token Event Logs</title>
</head>
<body>
  <h1>Token Event Logs</h1>
  <div id="logs"></div>

  <script>
    // Replace with your Etherscan API key and token contract address
    const etherscanApiKey = "AFFD2SXUNV3RY968V4442KMBP4928IBMJ7";
    const tokenContractAddress = "0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f"; // Replace with your token contract address

    async function fetchTokenEventLogs() {
      const apiUrl = `https://api.etherscan.io/api?module=logs&action=getLogs&fromBlock=0&toBlock=latest&address=${tokenContractAddress}&apikey=${etherscanApiKey}`;

      try {
        const response = await fetch(apiUrl);
        const data = await response.json();

        if (data.status === "1" && data.message === "OK") {
          const sortedLogs = data.result.sort((a, b) => b.timeStamp - a.timeStamp);
          displayEventLogs(sortedLogs);
        } else {
          console.error("Error fetching event logs:", data.message);
        }
      } catch (error) {
        console.error("Error fetching event logs:", error);
      }
    }

    function formatTimestamp(timestamp) {
      const date = new Date(timestamp * 1000);
      return date.toLocaleString();
    }

    function getMethodNameFromTopics(topics) {
      // The method name (signature) is the first topic (topics[0])
      const methodName = topics[0];
      return methodName;
    }

    function displayEventLogs(eventLogs) {
      const logsDiv = document.getElementById("logs");
      if (eventLogs.length === 0) {
        logsDiv.innerHTML = "No event logs found for the token.";
      } else {
        let html = "<ul>";
        eventLogs.forEach(eventLog => {
          const methodName = getMethodNameFromTopics(eventLog.topics);
          html += "<li>";
          html += `<strong>Date:</strong> ${formatTimestamp(eventLog.timeStamp)}<br>`;
          html += `<strong>Method Name:</strong> ${methodName}<br>`;
          html += `<strong>Block Number:</strong> ${eventLog.blockNumber}<br>`;
          html += `<strong>Transaction Hash:</strong> ${eventLog.transactionHash}<br>`;
          html += `<strong>Event Data:</strong> ${JSON.stringify(eventLog.data)}<br>`;
          html += "</li>";
        });
        html += "</ul>";
        logsDiv.innerHTML = html;
      }
    }

    fetchTokenEventLogs();
  </script>
</body>
</html>
