<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uniswap Liquidity Tokens - Infura</title>
</head>
<body>
    <h1>Uniswap Liquidity Tokens in the Last Few Hours - Infura</h1>
    <div id="tokenList"></div>

    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <script>
        const infuraApiKey = 'b80413fa91ea43f2a74700555827bcb4';
        const infuraEndpoint = `https://mainnet.infura.io/v3/${infuraApiKey}`;

        async function getLiquidityTokens() {
            if (typeof window.ethereum === 'undefined') {
                alert('Please install MetaMask or any other Ethereum wallet extension to use this website.');
                return;
            }

            const web3 = new Web3(infuraEndpoint);

            try {
                const currentTime = Math.floor(Date.now() / 1000);
                const oneDayAgo = currentTime - 86400; // 86400 seconds in a day

                const uniswapV2FactoryAddress = '0x5c69bee701ef814a2b6a3edd4b1652cb9cc5aa6f'; // Uniswap V2 Factory contract address
                const uniswapV2FactoryABI = [
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "allPairsLength",
                        "outputs": [
                            {
                                "internalType": "uint256",
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "stateMutability": "view",
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [
                            {
                                "internalType": "address",
                                "name": "tokenA",
                                "type": "address"
                            },
                            {
                                "internalType": "address",
                                "name": "tokenB",
                                "type": "address"
                            }
                        ],
                        "name": "getPair",
                        "outputs": [
                            {
                                "internalType": "address",
                                "name": "pair",
                                "type": "address"
                            }
                        ],
                        "payable": false,
                        "stateMutability": "view",
                        "type": "function"
                    },
                    {
                        "anonymous": false,
                        "inputs": [
                            {
                                "indexed": true,
                                "internalType": "address",
                                "name": "token0",
                                "type": "address"
                            },
                            {
                                "indexed": true,
                                "internalType": "address",
                                "name": "token1",
                                "type": "address"
                            },
                            {
                                "indexed": false,
                                "internalType": "address",
                                "name": "pair",
                                "type": "address"
                            },
                            {
                                "indexed": false,
                                "internalType": "uint256",
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "name": "PairCreated",
                        "type": "event"
                    }
                ];

                const uniswapV2FactoryContract = new web3.eth.Contract(uniswapV2FactoryABI, uniswapV2FactoryAddress);

                // Get the current number of pairs created in the factory
                const allPairsLength = await uniswapV2FactoryContract.methods.allPairsLength().call();

                const newTokenAddresses = new Set();

                // Loop through all pairs to get newly created token pairs
                for (let i = 0; i < allPairsLength; i++) {
                    const pairAddress = await uniswapV2FactoryContract.methods.allPairs(i).call();
                    newTokenAddresses.add(pairAddress);
                }

                displayTokenAddresses([...newTokenAddresses]);

            } catch (error) {
                console.error('Error:', error.message);
            }
        }

        function displayTokenAddresses(tokenAddresses) {
            const tokenListElement = document.getElementById('tokenList');
            tokenListElement.innerHTML = '';

            if (tokenAddresses.length === 0) {
                tokenListElement.innerHTML = '<p>No new tokens created in the last day.</p>';
                return;
            }

            const ul = document.createElement('ul');
            tokenAddresses.forEach((address) => {
                const li = document.createElement('li');
                li.textContent = address;
                ul.appendChild(li);
            });

            tokenListElement.appendChild(ul);
        }

        getLiquidityTokens();

    </script>
</body>
</html>
