<!DOCTYPE html>
<html>
<head>
    <title>Tokens with Recent Liquidity Addition</title>
</head>
<body>
    <h1>Tokens with Recent Liquidity Addition (Past 1 Hour)</h1>
    <ul id="tokenList"></ul>

    <script src="https://cdn.jsdelivr.net/npm/@apollo/client@3.4.26/dist/index.umd.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", async function () {
  const graphEndpoint = "https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2";

  // GraphQL query to fetch token pairs with their last liquidity addition timestamp
  const query = `
    {
      pairs(first: 1000, orderBy: createdAtTimestamp, orderDirection: desc) {
        id
        token0 {
          symbol
        }
        token1 {
          symbol
        }
        createdAtTimestamp
      }
    }
  `;

  // Fetch data from The Graph
  const client = new window.ApolloClient({ uri: graphEndpoint });
  const { data } = await client.query({ query });
  displayTokensWithLiquidity(data);
});

function displayTokensWithLiquidity(data) {
  const tokenListElement = document.getElementById("tokenList");
  const currentTime = Math.floor(Date.now() / 1000);
  const oneHourAgo = currentTime - (60 * 60); // 1 hour ago

  data.pairs.forEach(pair => {
    if (pair.createdAtTimestamp >= oneHourAgo) {
      const listItem = document.createElement("li");
      listItem.textContent = `Pair: ${pair.token0.symbol} - ${pair.token1.symbol}, Last Liquidity Addition: ${new Date(
        pair.createdAtTimestamp * 1000
      )}`;
      tokenListElement.appendChild(listItem);
    }
  });
}

    </script>
</body>
</html>
