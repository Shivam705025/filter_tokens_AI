<!DOCTYPE html>
<html>
<head>
  <title>Ethereum Contract Events</title>
</head>
<body>
  <h1>Contract Events</h1>
  <div id="events"></div>

  <!-- Add web3.js library -->
  <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      // Replace with your contract address
      const contractAddress = "0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f";

      // Check if Web3 is available
      if (typeof web3 !== "undefined") {
        // Use the existing provider (e.g., MetaMask)
        web3 = new Web3(web3.currentProvider);
      } else {
        // Set up a new provider (e.g., Infura)
        const provider = new Web3.providers.HttpProvider("https://mainnet.infura.io/v3/b80413fa91ea43f2a74700555827bcb4");
        web3 = new Web3(provider);
      }

      // Get contract instance
      const contract = new web3.eth.Contract([], contractAddress);

      // Get the latest block number
      const latestBlock = await web3.eth.getBlockNumber();

      // Calculate the starting block number to fetch only 200 events
      const fromBlock = latestBlock > 200 ? latestBlock - 200 : 0;

      try {
        const events = await contract.getPastEvents("allevents", {
          fromBlock: fromBlock,
          toBlock: "latest"
        });

        // Display events on the website
        const eventsDiv = document.getElementById("events");
        if (events.length === 0) {
          eventsDiv.innerHTML = "No events found for the specified contract.";
        } else {
          let html = "<ul>";
          events.forEach(event => {
            const eventData = JSON.stringify(event.returnValues);
            html += `<li>${eventData}</li>`;
          });
          html += "</ul>";
          eventsDiv.innerHTML = html;
        }
      } catch (error) {
        console.error("Error fetching events:", error);
      }
    });
  </script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
  <title>Token Event Logs</title>
</head>
<body>
  <h1>Token Event Logs</h1>
  <div id="logs"></div>

  <script>
    // Replace with your Etherscan API key and token contract address
    const etherscanApiKey = "AFFD2SXUNV3RY968V4442KMBP4928IBMJ7";
    const tokenContractAddress = "0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f"; // Replace with your token contract address

    async function fetchTokenEventLogs() {
      const apiUrl = `https://api.etherscan.io/api?module=logs&action=getLogs&fromBlock=0&toBlock=latest&address=${tokenContractAddress}&apikey=${etherscanApiKey}`;

      try {
        const response = await fetch(apiUrl);
        const data = await response.json();

        if (data.status === "1" && data.message === "OK") {
          displayEventLogs(data.result);
        } else {
          console.error("Error fetching event logs:", data.message);
        }
      } catch (error) {
        console.error("Error fetching event logs:", error);
      }
    }

    function displayEventLogs(eventLogs) {
      const logsDiv = document.getElementById("logs");
      if (eventLogs.length === 0) {
        logsDiv.innerHTML = "No event logs found for the token.";
      } else {
        let html = "<ul>";
        eventLogs.forEach(eventLog => {
          html += "<li>";
          html += `<strong>Block Number:</strong> ${eventLog.blockNumber}<br>`;
          html += `<strong>Transaction Hash:</strong> ${eventLog.transactionHash}<br>`;
          html += `<strong>Event Data:</strong> ${JSON.stringify(eventLog.data)}<br>`;
          html += "</li>";
        });
        html += "</ul>";
        logsDiv.innerHTML = html;
      }
    }

    fetchTokenEventLogs();
  </script>
</body>
</html>

